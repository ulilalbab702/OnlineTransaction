FROM node:10.15.0 as react-build

WORKDIR /app
COPY . .

ARG REACT_APP_X_IBM_CLIENT_ID
ARG REACT_APP_X_IBM_CLIENT_MSTEAMS
ARG REACT_APP_DOMAIN
ARG REACT_APP_API_URL
ARG REACT_APP_GOOGLE_MAPS_API_KEY
ARG REACT_APP_API_URL_OC
ARG REACT_APP_API_URL_TC
ARG REACT_APP_OCP_CLIENT
ARG REACT_APP_GOOGLE_CLIENT
ARG REACT_APP_FACEBOOK_CLIENT
ARG REACT_APP_API_KEY
ARG REACT_APP_AUTH_DOMAIN
ARG REACT_APP_DATABASE_URL
ARG REACT_APP_PROJECT_ID
ARG REACT_APP_STORAGE_BUCKET
ARG REACT_APP_MESSANDER_ID
ARG REACT_APP_APP_ID
ARG REACT_APP_MEASUREMENT_ID
ARG REACT_APP_SF_CHAT_URL
ARG REACT_APP_SF_CHAT_URL_CHATBOT
ARG REACT_APP_SF_CHAT_URL_ID
ARG REACT_APP_SF_BASELIVEAGENT
ARG REACT_APP_SF_DEPLOYMENT_ID
ARG REACT_APP_SF_BUTTON_ID
ARG REACT_APP_SF_BASELIVEAGENT_URL
ARG REACT_APP_SF_EMBEDDED_URL
ARG REACT_APP_APPLICATION_ID
ARG REACT_APP_CLEVERTAP_ID
ARG NODE_ENV

ENV REACT_APP_X_IBM_CLIENT_ID=$REACT_APP_X_IBM_CLIENT_ID
ENV REACT_APP_X_IBM_CLIENT_MSTEAMS=$REACT_APP_X_IBM_CLIENT_MSTEAMS
ENV REACT_APP_DOMAIN=$REACT_APP_DOMAIN
ENV REACT_APP_API_URL=$REACT_APP_API_URL
ENV REACT_APP_GOOGLE_MAPS_API_KEY=$REACT_APP_GOOGLE_MAPS_API_KEY
ENV REACT_APP_API_URL_OC=$REACT_APP_API_URL_OC
ENV REACT_APP_API_URL_TC=$REACT_APP_API_URL_TC
ENV REACT_APP_OCP_CLIENT=$REACT_APP_OCP_CLIENT
ENV REACT_APP_GOOGLE_CLIENT=$REACT_APP_GOOGLE_CLIENT
ENV REACT_APP_FACEBOOK_CLIENT=$REACT_APP_FACEBOOK_CLIENT
ENV REACT_APP_API_KEY=$REACT_APP_API_KEY
ENV REACT_APP_AUTH_DOMAIN=$REACT_APP_AUTH_DOMAIN
ENV REACT_APP_DATABASE_URL=$REACT_APP_DATABASE_URL
ENV REACT_APP_PROJECT_ID=$REACT_APP_PROJECT_ID
ENV REACT_APP_STORAGE_BUCKET=$REACT_APP_STORAGE_BUCKET
ENV REACT_APP_MESSANDER_ID=$REACT_APP_MESSANDER_ID
ENV REACT_APP_APP_ID=$REACT_APP_APP_ID
ENV REACT_APP_MEASUREMENT_ID=$REACT_APP_MEASUREMENT_ID
ENV REACT_APP_SF_CHAT_URL=$REACT_APP_SF_CHAT_URL
ENV REACT_APP_SF_CHAT_URL_CHATBOT=$REACT_APP_SF_CHAT_URL_CHATBOT
ENV REACT_APP_SF_CHAT_URL_ID=$REACT_APP_SF_CHAT_URL_ID
ENV REACT_APP_SF_BASELIVEAGENT=$REACT_APP_SF_BASELIVEAGENT
ENV REACT_APP_SF_DEPLOYMENT_ID=$REACT_APP_SF_DEPLOYMENT_ID
ENV REACT_APP_SF_BUTTON_ID=$REACT_APP_SF_BUTTON_ID
ENV REACT_APP_SF_BASELIVEAGENT_URL=$REACT_APP_SF_BASELIVEAGENT_URL
ENV REACT_APP_SF_EMBEDDED_URL=$REACT_APP_SF_EMBEDDED_URL
ENV REACT_APP_APPLICATION_ID=$REACT_APP_APPLICATION_ID
ENV REACT_APP_CLEVERTAP_ID=$REACT_APP_CLEVERTAP_ID
ENV NODE_ENV=$NODE_ENV

RUN npm install
RUN npm run build

EXPOSE 8080/tcp
CMD ["node", "app.js"]